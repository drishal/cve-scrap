#!/usr/bin/env python
import requests

url = "https://api.osv.dev/v1/vulns/OSV-2020-111"

response = requests.get(url)
data = response.json()

# Check if the API call was successful
if response.status_code == 200:
    id_ = data.get("id", "N/A")
    summary = data.get("summary", "N/A")
    details = data.get("details", "N/A")
    introduced = data.get("affected", [{}])[0].get("ranges", [{}])[0].get("events", [{}])[0].get("introduced", "N/A")
    fixed = data.get("affected", [{}])[0].get("ranges", [{}])[0].get("events", [{}])[1].get("fixed", "N/A")

    print(f"id: {id_}")
    print(f"summary: {summary}")
    print(f"details: {details}")
    print(f"introduced: {introduced}")
    print(f"fixed: {fixed}")
else:
    print(f"Failed to fetch data. Status code: {response.status_code}")
